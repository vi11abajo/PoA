<!DOCTYPE html>
<html>
<head>
    <title>🧪 Test ID Generation</title>
    <style>
        body { font-family: monospace; background: #001122; color: #00ddff; padding: 20px; }
        button { background: #00ddff; color: #001122; border: none; padding: 10px 15px; margin: 5px; border-radius: 4px; cursor: pointer; }
        .result { background: #003366; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { color: #00ff88; }
        .error { color: #ff4444; }
        .warning { color: #ffaa00; }
    </style>
</head>
<body>
    <h1>🧪 Tournament ID Generation Test</h1>
    
    <button onclick="testRandomGeneration()">🎲 Test Random Generation</button>
    <button onclick="testTimestampGeneration()">⏰ Test Timestamp Generation</button>
    <button onclick="testSequentialGeneration()">📈 Test Sequential Generation</button>
    <button onclick="testAllStrategies()">🔄 Test All Strategies</button>
    
    <div id="results"></div>

    <script src="https://cdn.jsdelivr.net/npm/web3@4.2.2/dist/web3.min.js"></script>
    <script>
        const results = document.getElementById('results');

        function addResult(title, content, type = 'info') {
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : type === 'warning' ? 'warning' : '';
            results.innerHTML += `
                <div class="result">
                    <strong>${title}</strong><br>
                    <span class="${className}">${content}</span>
                </div>
            `;
        }

        // Simulate the ID generation functions from tournament-manager.js
        function generateRandomTournamentId() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = '';
            for (let i = 0; i < 6; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            const numericId = parseInt(result, 36);
            return { string: result, numeric: numericId };
        }

        function generateTimestampTournamentId() {
            const timestamp = Date.now();
            const random = Math.floor(Math.random() * 1000);
            const tournamentId = timestamp * 1000 + random;
            return tournamentId;
        }

        function testRandomGeneration() {
            addResult('🎲 Random ID Generation Test', '', 'info');
            
            for (let i = 0; i < 5; i++) {
                const generated = generateRandomTournamentId();
                addResult(
                    `Random ID ${i+1}:`,
                    `${generated.string} → ${generated.numeric}`,
                    'success'
                );
                
                // Test if it's a valid uint256
                if (generated.numeric > 0 && generated.numeric < Number.MAX_SAFE_INTEGER) {
                    addResult(`  Validation:`, '✅ Valid uint256', 'success');
                } else {
                    addResult(`  Validation:`, '❌ Invalid range', 'error');
                }
            }
        }

        function testTimestampGeneration() {
            addResult('⏰ Timestamp ID Generation Test', '', 'info');
            
            for (let i = 0; i < 3; i++) {
                const generated = generateTimestampTournamentId();
                const date = new Date(Math.floor(generated / 1000));
                addResult(
                    `Timestamp ID ${i+1}:`,
                    `${generated} (${date.toLocaleString()})`,
                    'success'
                );
                
                // Small delay to ensure uniqueness
                setTimeout(() => {}, 10);
            }
        }

        function testSequentialGeneration() {
            addResult('📈 Sequential ID Simulation', '', 'info');
            
            // Simulate checking sequential IDs
            const simulatedUsedIds = [1, 2, 5, 7]; // Pretend these are used
            
            for (let id = 1; id <= 10; id++) {
                const isUsed = simulatedUsedIds.includes(id);
                const status = isUsed ? '❌ Used' : '✅ Available';
                const color = isUsed ? 'error' : 'success';
                
                addResult(`ID ${id}:`, status, color);
                
                if (!isUsed && id > 1) {
                    addResult('  Next Sequential:', `Would use ID ${id}`, 'success');
                    break;
                }
            }
        }

        function testAllStrategies() {
            results.innerHTML = '';
            
            addResult('🧪 Complete ID Generation Test', 'Testing all strategies...', 'info');
            
            // Test random
            const random = generateRandomTournamentId();
            addResult('Random Strategy:', `${random.string} → ${random.numeric}`, 'success');
            
            // Test timestamp  
            const timestamp = generateTimestampTournamentId();
            addResult('Timestamp Strategy:', `${timestamp}`, 'success');
            
            // Simulate sequential
            addResult('Sequential Strategy:', 'Would find next available ID (simulated)', 'success');
            
            // Compatibility test
            addResult('Smart Contract Compatibility:', '', 'info');
            
            const testIds = [random.numeric, timestamp, 999999];
            testIds.forEach((id, index) => {
                if (id > 0 && id < Number.MAX_SAFE_INTEGER) {
                    addResult(`  Test ID ${index + 1} (${id}):`, '✅ Compatible with uint256', 'success');
                } else {
                    addResult(`  Test ID ${index + 1} (${id}):`, '❌ May have issues', 'error');
                }
            });
            
            // Final recommendation
            addResult('💡 Recommendation:', 'All strategies work with smart contracts. Sequential is safest, Random is most unique.', 'warning');
        }

        // Auto-run basic test
        addResult('🚀 ID Generation Tester', 'Click buttons to test different strategies', 'info');
    </script>
</body>
</html>